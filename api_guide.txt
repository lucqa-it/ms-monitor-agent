kdon@lim-lucqa-001:/opt/ms/monitor/ms-monitor-agent$ pm2 restart 0
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [0](ids: [ '0' ])
[PM2] [monitor-agent](0) ✓
┌────┬──────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name             │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼──────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 0  │ monitor-agent    │ default     │ 1.0.0   │ fork    │ 2361910  │ 0s     │ 18   │ online    │ 0%       │ 16.9mb   │ kdon     │ disabled │
└────┴──────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
kdon@lim-lucqa-001:/opt/ms/monitor/ms-monitor-agent$ sudo ufw status
# Debería decir: Status: active
Status: active

To                         Action      From
--                         ------      ----
21113/udp                  ALLOW       Anywhere                  
21115/tcp                  ALLOW       Anywhere                  
21116/tcp                  ALLOW       Anywhere                  
9091/tcp                   ALLOW       Anywhere                  
9090/tcp                   ALLOW       Anywhere                  
1194/tcp                   ALLOW       Anywhere                  
OpenSSH                    ALLOW       Anywhere                  
51820/udp                  ALLOW       Anywhere                  
8081/tcp                   ALLOW       Anywhere                  
80/tcp                     ALLOW       Anywhere                  
7844/udp                   ALLOW       Anywhere                  
443/udp                    ALLOW       Anywhere                  
443/tcp                    ALLOW       Anywhere                  
3456/tcp                   ALLOW       Anywhere                  
21113/udp (v6)             ALLOW       Anywhere (v6)             
21115/tcp (v6)             ALLOW       Anywhere (v6)             
21116/tcp (v6)             ALLOW       Anywhere (v6)             
9091/tcp (v6)              ALLOW       Anywhere (v6)             
9090/tcp (v6)              ALLOW       Anywhere (v6)             
1194/tcp (v6)              ALLOW       Anywhere (v6)             
OpenSSH (v6)               ALLOW       Anywhere (v6)             
51820/udp (v6)             ALLOW       Anywhere (v6)             
8081/tcp (v6)              ALLOW       Anywhere (v6)             
80/tcp (v6)                ALLOW       Anywhere (v6)             
7844/udp (v6)              ALLOW       Anywhere (v6)             
443/udp (v6)               ALLOW       Anywhere (v6)             
443/tcp (v6)               ALLOW       Anywhere (v6)             
3456/tcp (v6)              ALLOW       Anywhere (v6)             

kdon@lim-lucqa-001:/opt/ms/monitor/ms-monitor-agent$ sudo systemctl status firewalld
# Debería decir: Active: active (running)
Unit firewalld.service could not be found.
kdon@lim-lucqa-001:/opt/ms/monitor/ms-monitor-agent$ sudo iptables -L -n -v
# Si ves muchas líneas de reglas (ACCEPT/DROP), está activo.
# Si ves todo vacío (Policy ACCEPT), está inactivo.
Chain INPUT (policy DROP 297 packets, 8316 bytes)
 pkts bytes target     prot opt in     out     source               destination         
 9121 3972K ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:3456
    0     0 ACCEPT     all  --  docker0 *       0.0.0.0/0            0.0.0.0/0           
    0     0 ACCEPT     tcp  --  *      *       172.16.0.0/12        0.0.0.0/0            tcp dpt:53
 8605  581K ACCEPT     udp  --  *      *       172.16.0.0/12        0.0.0.0/0            udp dpt:53
  12M   12G ufw-before-logging-input  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
  12M   12G ufw-before-input  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
83144   13M ufw-after-input  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
12847  389K ufw-after-logging-input  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
12847  389K ufw-reject-input  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
12847  389K ufw-track-input  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain FORWARD (policy DROP 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
 509K  349M DOCKER-USER  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
 509K  349M DOCKER-FORWARD  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ufw-before-logging-forward  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ufw-before-forward  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ufw-after-forward  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ufw-after-logging-forward  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ufw-reject-forward  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ufw-track-forward  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain OUTPUT (policy ACCEPT 1 packets, 52 bytes)
 pkts bytes target     prot opt in     out     source               destination         
9802K 8591M ufw-before-logging-output  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
9802K 8591M ufw-before-output  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
37617 3363K ufw-after-output  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
37617 3363K ufw-after-logging-output  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
37617 3363K ufw-reject-output  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
37617 3363K ufw-track-output  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain DOCKER (4 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 ACCEPT     tcp  --  !br-294beb14502a br-294beb14502a  0.0.0.0/0            172.20.0.15          tcp dpt:8080
    0     0 ACCEPT     tcp  --  !br-294beb14502a br-294beb14502a  0.0.0.0/0            172.20.0.15          tcp dpt:5432
    0     0 ACCEPT     tcp  --  !br-294beb14502a br-294beb14502a  0.0.0.0/0            172.20.0.15          tcp dpt:443
 4219  219K ACCEPT     tcp  --  !br-294beb14502a br-294beb14502a  0.0.0.0/0            172.20.0.15          tcp dpt:80
    0     0 ACCEPT     tcp  --  !br-294beb14502a br-294beb14502a  0.0.0.0/0            172.20.0.13          tcp dpt:8200
  938 48776 ACCEPT     tcp  --  !br-294beb14502a br-294beb14502a  0.0.0.0/0            172.20.0.11          tcp dpt:5432
    0     0 DROP       all  --  !br-8b0b64adc4b3 br-8b0b64adc4b3  0.0.0.0/0            0.0.0.0/0           
    0     0 DROP       all  --  !br-0c88756fd812 br-0c88756fd812  0.0.0.0/0            0.0.0.0/0           
    0     0 DROP       all  --  !br-294beb14502a br-294beb14502a  0.0.0.0/0            0.0.0.0/0           
    0     0 DROP       all  --  !docker0 docker0  0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-BRIDGE (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DOCKER     all  --  *      br-8b0b64adc4b3  0.0.0.0/0            0.0.0.0/0           
    0     0 DOCKER     all  --  *      br-0c88756fd812  0.0.0.0/0            0.0.0.0/0           
 8311  432K DOCKER     all  --  *      br-294beb14502a  0.0.0.0/0            0.0.0.0/0           
    0     0 DOCKER     all  --  *      docker0  0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-CT (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 ACCEPT     all  --  *      br-8b0b64adc4b3  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  *      br-0c88756fd812  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
 255K  164M ACCEPT     all  --  *      br-294beb14502a  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  *      docker0  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED

Chain DOCKER-FORWARD (1 references)
 pkts bytes target     prot opt in     out     source               destination         
 509K  349M DOCKER-CT  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
 254K  185M DOCKER-INTERNAL  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
 254K  185M DOCKER-BRIDGE  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ACCEPT     all  --  br-8b0b64adc4b3 *       0.0.0.0/0            0.0.0.0/0           
    0     0 ACCEPT     all  --  br-0c88756fd812 *       0.0.0.0/0            0.0.0.0/0           
 245K  185M ACCEPT     all  --  br-294beb14502a *       0.0.0.0/0            0.0.0.0/0           
    0     0 ACCEPT     all  --  docker0 *       0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-INTERNAL (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain DOCKER-USER (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-after-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-after-input (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  422 34248 ufw-skip-to-policy-input  udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:137
    0     0 ufw-skip-to-policy-input  udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:138
    0     0 ufw-skip-to-policy-input  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:139
    0     0 ufw-skip-to-policy-input  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:445
   17  5742 ufw-skip-to-policy-input  udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:67
    0     0 ufw-skip-to-policy-input  udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:68
  642  115K ufw-skip-to-policy-input  all  --  *      *       0.0.0.0/0            0.0.0.0/0            ADDRTYPE match dst-type BROADCAST

Chain ufw-after-logging-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 LOG        all  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 3/min burst 10 LOG flags 0 level 4 prefix "[UFW BLOCK] "

Chain ufw-after-logging-input (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  297  8316 LOG        all  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 3/min burst 10 LOG flags 0 level 4 prefix "[UFW BLOCK] "

Chain ufw-after-logging-output (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-after-output (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-before-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 3
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 11
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 12
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8
    0     0 ufw-user-forward  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain ufw-before-input (1 references)
 pkts bytes target     prot opt in     out     source               destination         
55560   71M ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0           
42214   21M ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
    0     0 ufw-logging-deny  all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate INVALID
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate INVALID
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 3
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 11
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 12
    0     0 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8
    0     0 ACCEPT     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp spt:67 dpt:68
 1387  164K ufw-not-local  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ACCEPT     udp  --  *      *       0.0.0.0/0            224.0.0.251          udp dpt:5353
    0     0 ACCEPT     udp  --  *      *       0.0.0.0/0            239.255.255.250      udp dpt:1900
 1387  164K ufw-user-input  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain ufw-before-logging-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-before-logging-input (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-before-logging-output (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-before-output (1 references)
 pkts bytes target     prot opt in     out     source               destination         
55560   71M ACCEPT     all  --  *      lo      0.0.0.0/0            0.0.0.0/0           
34645   15M ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
  570 45112 ufw-user-output  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain ufw-logging-allow (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 LOG        all  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 3/min burst 10 LOG flags 0 level 4 prefix "[UFW ALLOW] "

Chain ufw-logging-deny (2 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate INVALID limit: avg 3/min burst 10
    0     0 LOG        all  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 3/min burst 10 LOG flags 0 level 4 prefix "[UFW BLOCK] "

Chain ufw-not-local (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    9   516 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ADDRTYPE match dst-type LOCAL
  297  8316 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ADDRTYPE match dst-type MULTICAST
 1081  155K RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ADDRTYPE match dst-type BROADCAST
    0     0 ufw-logging-deny  all  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 3/min burst 10
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain ufw-reject-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-reject-input (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-reject-output (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-skip-to-policy-forward (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain ufw-skip-to-policy-input (7 references)
 pkts bytes target     prot opt in     out     source               destination         
 1081  155K DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain ufw-skip-to-policy-output (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain ufw-track-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-track-input (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-track-output (1 references)
 pkts bytes target     prot opt in     out     source               destination         
   99  5940 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate NEW
  470 39120 ACCEPT     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate NEW

Chain ufw-user-forward (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-user-input (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 ACCEPT     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:21113
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:21115
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:21116
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:9091
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:9090
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:1194
    9   516 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:22 /* 'dapp_OpenSSH' */
    0     0 ACCEPT     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:51820
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:8081
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80
    0     0 ACCEPT     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:7844
    0     0 ACCEPT     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:443
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:443
    0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:3456

Chain ufw-user-limit (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 LOG        all  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 3/min burst 5 LOG flags 0 level 4 prefix "[UFW LIMIT BLOCK] "
    0     0 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable

Chain ufw-user-limit-accept (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain ufw-user-logging-forward (0 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-user-logging-input (0 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-user-logging-output (0 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain ufw-user-output (1 references)
 pkts bytes target     prot opt in     out     source               destination         
kdon@lim-lucqa-001:/opt/ms/monitor/ms-monitor-agent$ sudo nft list ruleset
# Si devuelve reglas, está activo.
table ip raw {
        chain PREROUTING {
                type filter hook prerouting priority raw; policy accept;
                iifname != "br-294beb14502a" ip daddr 172.20.0.2 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.3 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.4 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.6 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.7 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.8 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.9 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.11 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.12 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.13 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.14 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.16 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.10 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.5 counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" ip daddr 172.20.0.15 counter packets 0 bytes 0 drop
        }

        chain OUTPUT {
                type filter hook output priority raw; policy accept;
        }
}
table ip filter {
        chain INPUT {
                type filter hook input priority filter; policy drop;
                meta l4proto tcp tcp dport 3456 counter packets 9129 bytes 3975793 accept
                iifname "docker0" counter packets 0 bytes 0 accept
                meta l4proto tcp ip saddr 172.16.0.0/12 tcp dport 53 counter packets 0 bytes 0 accept
                meta l4proto udp ip saddr 172.16.0.0/12 udp dport 53 counter packets 8605 bytes 581125 accept
                counter packets 11632146 bytes 12144430608 jump ufw-before-logging-input
                counter packets 11632146 bytes 12144430608 jump ufw-before-input
                counter packets 83145 bytes 12718663 jump ufw-after-input
                counter packets 12848 bytes 388959 jump ufw-after-logging-input
                counter packets 12848 bytes 388959 jump ufw-reject-input
                counter packets 12848 bytes 388959 jump ufw-track-input
        }

        chain FORWARD {
                type filter hook forward priority filter; policy drop;
                counter packets 508723 bytes 349342602 jump DOCKER-USER
                counter packets 508723 bytes 349342602 jump DOCKER-FORWARD
                counter packets 0 bytes 0 jump ufw-before-logging-forward
                counter packets 0 bytes 0 jump ufw-before-forward
                counter packets 0 bytes 0 jump ufw-after-forward
                counter packets 0 bytes 0 jump ufw-after-logging-forward
                counter packets 0 bytes 0 jump ufw-reject-forward
                counter packets 0 bytes 0 jump ufw-track-forward
        }

        chain OUTPUT {
                type filter hook output priority filter; policy accept;
                counter packets 9802500 bytes 8590790911 jump ufw-before-logging-output
                counter packets 9802500 bytes 8590790911 jump ufw-before-output
                counter packets 37617 bytes 3362548 jump ufw-after-output
                counter packets 37617 bytes 3362548 jump ufw-after-logging-output
                counter packets 37617 bytes 3362548 jump ufw-reject-output
                counter packets 37617 bytes 3362548 jump ufw-track-output
        }

        chain DOCKER-FORWARD {
                counter packets 508723 bytes 349342602 jump DOCKER-CT
                counter packets 253780 bytes 185160299 jump DOCKER-INTERNAL
                counter packets 253780 bytes 185160299 jump DOCKER-BRIDGE
                iifname "br-8b0b64adc4b3" counter packets 0 bytes 0 accept
                iifname "br-0c88756fd812" counter packets 0 bytes 0 accept
                iifname "br-294beb14502a" counter packets 245465 bytes 184727919 accept
                iifname "docker0" counter packets 0 bytes 0 accept
        }

        chain DOCKER-USER {
        }

        chain ufw-after-forward {
        }

        chain ufw-after-input {
                meta l4proto udp udp dport 137 counter packets 422 bytes 34248 jump ufw-skip-to-policy-input
                meta l4proto udp udp dport 138 counter packets 0 bytes 0 jump ufw-skip-to-policy-input
                meta l4proto tcp tcp dport 139 counter packets 0 bytes 0 jump ufw-skip-to-policy-input
                meta l4proto tcp tcp dport 445 counter packets 0 bytes 0 jump ufw-skip-to-policy-input
                meta l4proto udp udp dport 67 counter packets 17 bytes 5742 jump ufw-skip-to-policy-input
                meta l4proto udp udp dport 68 counter packets 0 bytes 0 jump ufw-skip-to-policy-input
                fib daddr type broadcast counter packets 642 bytes 115240 jump ufw-skip-to-policy-input
        }

        chain ufw-after-logging-forward {
                limit rate 3/minute burst 10 packets counter packets 0 bytes 0 log prefix "[UFW BLOCK] "
        }

        chain ufw-after-logging-input {
                limit rate 3/minute burst 10 packets counter packets 298 bytes 8344 log prefix "[UFW BLOCK] "
        }

        chain ufw-after-logging-output {
        }

        chain ufw-after-output {
        }

        chain ufw-before-forward {
                ct state related,established counter packets 0 bytes 0 accept
                meta l4proto icmp icmp type destination-unreachable counter packets 0 bytes 0 accept
                meta l4proto icmp icmp type time-exceeded counter packets 0 bytes 0 accept
                meta l4proto icmp icmp type parameter-problem counter packets 0 bytes 0 accept
                meta l4proto icmp icmp type echo-request counter packets 0 bytes 0 accept
                counter packets 0 bytes 0 jump ufw-user-forward
        }

        chain ufw-before-input {
                iifname "lo" counter packets 55601 bytes 70698159 accept
                ct state related,established counter packets 42273 bytes 21485378 accept
                ct state invalid counter packets 0 bytes 0 jump ufw-logging-deny
                ct state invalid counter packets 0 bytes 0 drop
                meta l4proto icmp icmp type destination-unreachable counter packets 0 bytes 0 accept
                meta l4proto icmp icmp type time-exceeded counter packets 0 bytes 0 accept
                meta l4proto icmp icmp type parameter-problem counter packets 0 bytes 0 accept
                meta l4proto icmp icmp type echo-request counter packets 0 bytes 0 accept
                meta l4proto udp udp sport 67 udp dport 68 counter packets 0 bytes 0 accept
                counter packets 1388 bytes 164090 jump ufw-not-local
                meta l4proto udp ip daddr 224.0.0.251 udp dport 5353 counter packets 0 bytes 0 accept
                meta l4proto udp ip daddr 239.255.255.250 udp dport 1900 counter packets 0 bytes 0 accept
                counter packets 1388 bytes 164090 jump ufw-user-input
        }

        chain ufw-before-logging-forward {
        }

        chain ufw-before-logging-input {
        }

        chain ufw-before-logging-output {
        }

        chain ufw-before-output {
                oifname "lo" counter packets 55601 bytes 70698159 accept
                ct state related,established counter packets 34729 bytes 14747367 accept
                counter packets 570 bytes 45112 jump ufw-user-output
        }

        chain ufw-reject-forward {
        }

        chain ufw-reject-input {
        }

        chain ufw-reject-output {
        }

        chain ufw-track-forward {
        }

        chain ufw-track-input {
        }

        chain ufw-track-output {
                meta l4proto tcp ct state new counter packets 99 bytes 5940 accept
                meta l4proto udp ct state new counter packets 470 bytes 39120 accept
        }

        chain DOCKER {
                iifname != "br-294beb14502a" oifname "br-294beb14502a" meta l4proto tcp ip daddr 172.20.0.15 tcp dport 8080 counter packets 0 bytes 0 accept
                iifname != "br-294beb14502a" oifname "br-294beb14502a" meta l4proto tcp ip daddr 172.20.0.15 tcp dport 5432 counter packets 0 bytes 0 accept
                iifname != "br-294beb14502a" oifname "br-294beb14502a" meta l4proto tcp ip daddr 172.20.0.15 tcp dport 443 counter packets 0 bytes 0 accept
                iifname != "br-294beb14502a" oifname "br-294beb14502a" meta l4proto tcp ip daddr 172.20.0.15 tcp dport 80 counter packets 4223 bytes 219596 accept
                iifname != "br-294beb14502a" oifname "br-294beb14502a" meta l4proto tcp ip daddr 172.20.0.13 tcp dport 8200 counter packets 0 bytes 0 accept
                iifname != "br-294beb14502a" oifname "br-294beb14502a" meta l4proto tcp ip daddr 172.20.0.11 tcp dport 5432 counter packets 938 bytes 48776 accept
                iifname != "br-8b0b64adc4b3" oifname "br-8b0b64adc4b3" counter packets 0 bytes 0 drop
                iifname != "br-0c88756fd812" oifname "br-0c88756fd812" counter packets 0 bytes 0 drop
                iifname != "br-294beb14502a" oifname "br-294beb14502a" counter packets 0 bytes 0 drop
                iifname != "docker0" oifname "docker0" counter packets 0 bytes 0 drop
        }

        chain DOCKER-BRIDGE {
                oifname "br-8b0b64adc4b3" counter packets 0 bytes 0 jump DOCKER
                oifname "br-0c88756fd812" counter packets 0 bytes 0 jump DOCKER
                oifname "br-294beb14502a" counter packets 8315 bytes 432380 jump DOCKER
                oifname "docker0" counter packets 0 bytes 0 jump DOCKER
        }

        chain DOCKER-CT {
                oifname "br-8b0b64adc4b3" ct state related,established counter packets 0 bytes 0 accept
                oifname "br-0c88756fd812" ct state related,established counter packets 0 bytes 0 accept
                oifname "br-294beb14502a" ct state related,established counter packets 254943 bytes 164182303 accept
                oifname "docker0" ct state related,established counter packets 0 bytes 0 accept
        }

        chain DOCKER-INTERNAL {
        }

        chain ufw-logging-deny {
                ct state invalid limit rate 3/minute burst 10 packets counter packets 0 bytes 0 return
                limit rate 3/minute burst 10 packets counter packets 0 bytes 0 log prefix "[UFW BLOCK] "
        }

        chain ufw-logging-allow {
                limit rate 3/minute burst 10 packets counter packets 0 bytes 0 log prefix "[UFW ALLOW] "
        }

        chain ufw-skip-to-policy-input {
                counter packets 1081 bytes 155230 drop
        }

        chain ufw-skip-to-policy-output {
                counter packets 0 bytes 0 accept
        }

        chain ufw-skip-to-policy-forward {
                counter packets 0 bytes 0 drop
        }

        chain ufw-not-local {
                fib daddr type local counter packets 9 bytes 516 return
                fib daddr type multicast counter packets 298 bytes 8344 return
                fib daddr type broadcast counter packets 1081 bytes 155230 return
                limit rate 3/minute burst 10 packets counter packets 0 bytes 0 jump ufw-logging-deny
                counter packets 0 bytes 0 drop
        }

        chain ufw-user-input {
                meta l4proto udp udp dport 21113 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 21115 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 21116 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 9091 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 9090 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 1194 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 22  counter packets 9 bytes 516 accept
                meta l4proto udp udp dport 51820 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 8081 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 80 counter packets 0 bytes 0 accept
                meta l4proto udp udp dport 7844 counter packets 0 bytes 0 accept
                meta l4proto udp udp dport 443 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 443 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 3456 counter packets 0 bytes 0 accept
        }

        chain ufw-user-output {
        }

        chain ufw-user-forward {
        }

        chain ufw-user-logging-input {
        }

        chain ufw-user-logging-output {
        }

        chain ufw-user-logging-forward {
        }

        chain ufw-user-limit {
                limit rate 3/minute counter packets 0 bytes 0 log prefix "[UFW LIMIT BLOCK] "
                counter packets 0 bytes 0 reject
        }

        chain ufw-user-limit-accept {
                counter packets 0 bytes 0 accept
        }
}
table ip nat {
        chain PREROUTING {
                type nat hook prerouting priority dstnat; policy accept;
                fib daddr type local counter packets 17599 bytes 1053485 jump DOCKER
        }

        chain INPUT {
                type nat hook input priority 100; policy accept;
        }

        chain OUTPUT {
                type nat hook output priority -100; policy accept;
                ip daddr != 127.0.0.0/8 fib daddr type local counter packets 2259 bytes 135540 jump DOCKER
        }

        chain POSTROUTING {
                type nat hook postrouting priority srcnat; policy accept;
                oifname != "docker0" ip saddr 172.17.0.0/16 counter packets 0 bytes 0 masquerade 
                oifname != "br-8b0b64adc4b3" ip saddr 172.19.0.0/16 counter packets 0 bytes 0 masquerade 
                oifname != "br-294beb14502a" ip saddr 172.20.0.0/16 counter packets 4185 bytes 251092 masquerade 
                oifname != "br-0c88756fd812" ip saddr 172.18.0.0/16 counter packets 0 bytes 0 masquerade 
        }

        chain DOCKER {
                iifname != "br-294beb14502a" meta l4proto tcp tcp dport 5433 counter packets 2128 bytes 120176 dnat to 172.20.0.11:5432
                iifname != "br-294beb14502a" meta l4proto tcp tcp dport 8200 counter packets 0 bytes 0 dnat to 172.20.0.13:8200
                iifname != "br-294beb14502a" meta l4proto tcp tcp dport 80 counter packets 4223 bytes 219596 dnat to 172.20.0.15:80
                iifname != "br-294beb14502a" meta l4proto tcp tcp dport 443 counter packets 0 bytes 0 dnat to 172.20.0.15:443
                iifname != "br-294beb14502a" meta l4proto tcp tcp dport 5432 counter packets 0 bytes 0 dnat to 172.20.0.15:5432
                iifname != "br-294beb14502a" meta l4proto tcp tcp dport 8080 counter packets 0 bytes 0 dnat to 172.20.0.15:8080
        }
}
table ip6 filter {
        chain INPUT {
                type filter hook input priority filter; policy drop;
                counter packets 3941159 bytes 230584263 jump ufw6-before-logging-input
                counter packets 3941159 bytes 230584263 jump ufw6-before-input
                counter packets 2 bytes 117 jump ufw6-after-input
                counter packets 2 bytes 117 jump ufw6-after-logging-input
                counter packets 2 bytes 117 jump ufw6-reject-input
                counter packets 2 bytes 117 jump ufw6-track-input
        }

        chain FORWARD {
                type filter hook forward priority filter; policy drop;
                counter packets 0 bytes 0 jump DOCKER-USER
                counter packets 0 bytes 0 jump DOCKER-FORWARD
                counter packets 0 bytes 0 jump ufw6-before-logging-forward
                counter packets 0 bytes 0 jump ufw6-before-forward
                counter packets 0 bytes 0 jump ufw6-after-forward
                counter packets 0 bytes 0 jump ufw6-after-logging-forward
                counter packets 0 bytes 0 jump ufw6-reject-forward
                counter packets 0 bytes 0 jump ufw6-track-forward
        }

        chain OUTPUT {
                type filter hook output priority filter; policy accept;
                counter packets 3950097 bytes 231067181 jump ufw6-before-logging-output
                counter packets 3950097 bytes 231067181 jump ufw6-before-output
                counter packets 447 bytes 35519 jump ufw6-after-output
                counter packets 447 bytes 35519 jump ufw6-after-logging-output
                counter packets 447 bytes 35519 jump ufw6-reject-output
                counter packets 447 bytes 35519 jump ufw6-track-output
        }

        chain DOCKER-FORWARD {
                counter packets 0 bytes 0 jump DOCKER-CT
                counter packets 0 bytes 0 jump DOCKER-INTERNAL
                counter packets 0 bytes 0 jump DOCKER-BRIDGE
        }

        chain DOCKER-USER {
        }

        chain ufw6-after-forward {
        }

        chain ufw6-after-input {
                meta l4proto udp udp dport 137 counter packets 0 bytes 0 jump ufw6-skip-to-policy-input
                meta l4proto udp udp dport 138 counter packets 0 bytes 0 jump ufw6-skip-to-policy-input
                meta l4proto tcp tcp dport 139 counter packets 0 bytes 0 jump ufw6-skip-to-policy-input
                meta l4proto tcp tcp dport 445 counter packets 0 bytes 0 jump ufw6-skip-to-policy-input
                meta l4proto udp udp dport 546 counter packets 0 bytes 0 jump ufw6-skip-to-policy-input
                meta l4proto udp udp dport 547 counter packets 0 bytes 0 jump ufw6-skip-to-policy-input
        }

        chain ufw6-after-logging-forward {
                limit rate 3/minute burst 10 packets counter packets 0 bytes 0 log prefix "[UFW BLOCK] "
        }

        chain ufw6-after-logging-input {
                limit rate 3/minute burst 10 packets counter packets 0 bytes 0 log prefix "[UFW BLOCK] "
        }

        chain ufw6-after-logging-output {
        }

        chain ufw6-after-output {
        }

        chain ufw6-before-forward {
                rt type 0 counter packets 0 bytes 0 drop
                ct state related,established counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type destination-unreachable counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type packet-too-big counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type time-exceeded counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type parameter-problem counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type echo-request counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type echo-reply counter packets 0 bytes 0 accept
                counter packets 0 bytes 0 jump ufw6-user-forward
        }

        chain ufw6-before-input {
                iifname "lo" counter packets 35690 bytes 2087865 accept
                rt type 0 counter packets 0 bytes 0 drop
                ct state related,established counter packets 8 bytes 1056 accept
                meta l4proto ipv6-icmp icmpv6 type echo-reply counter packets 0 bytes 0 accept
                ct state invalid counter packets 0 bytes 0 jump ufw6-logging-deny
                ct state invalid counter packets 0 bytes 0 drop
                meta l4proto ipv6-icmp icmpv6 type destination-unreachable counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type packet-too-big counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type time-exceeded counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type parameter-problem counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type echo-request counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type nd-router-solicit ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type nd-router-advert ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type nd-neighbor-solicit ip6 hoplimit 255 counter packets 2 bytes 144 accept
                meta l4proto ipv6-icmp icmpv6 type nd-neighbor-advert ip6 hoplimit 255 counter packets 9 bytes 632 accept
                meta l4proto ipv6-icmp icmpv6 type  ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  ip6 hoplimit 1 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  ip6 hoplimit 1 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  ip6 hoplimit 1 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto udp ip6 saddr fe80::/10 ip6 daddr fe80::/10 udp sport 547 udp dport 546 counter packets 0 bytes 0 accept
                meta l4proto udp ip6 daddr ff02::fb udp dport 5353 counter packets 0 bytes 0 accept
                meta l4proto udp ip6 daddr ff02::f udp dport 1900 counter packets 0 bytes 0 accept
                counter packets 0 bytes 0 jump ufw6-user-input
        }

        chain ufw6-before-logging-forward {
        }

        chain ufw6-before-logging-input {
        }

        chain ufw6-before-logging-output {
        }

        chain ufw6-before-output {
                oifname "lo" counter packets 35690 bytes 2087865 accept
                rt type 0 counter packets 0 bytes 0 drop
                ct state related,established counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type destination-unreachable counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type packet-too-big counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type time-exceeded counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type parameter-problem counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type echo-request counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type echo-reply counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type nd-router-solicit ip6 hoplimit 255 counter packets 89 bytes 4864 accept
                meta l4proto ipv6-icmp icmpv6 type nd-neighbor-advert ip6 hoplimit 255 counter packets 2 bytes 128 accept
                meta l4proto ipv6-icmp icmpv6 type nd-neighbor-solicit ip6 hoplimit 255 counter packets 2 bytes 144 accept
                meta l4proto ipv6-icmp icmpv6 type nd-router-advert ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp icmpv6 type  ip6 hoplimit 255 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  ip6 hoplimit 1 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  ip6 hoplimit 1 counter packets 0 bytes 0 accept
                meta l4proto ipv6-icmp ip6 saddr fe80::/10 icmpv6 type  ip6 hoplimit 1 counter packets 0 bytes 0 accept
                counter packets 8 bytes 672 jump ufw6-user-output
        }

        chain ufw6-reject-forward {
        }

        chain ufw6-reject-input {
        }

        chain ufw6-reject-output {
        }

        chain ufw6-track-forward {
        }

        chain ufw6-track-input {
        }

        chain ufw6-track-output {
                meta l4proto tcp ct state new counter packets 6 bytes 480 accept
                meta l4proto udp ct state new counter packets 2 bytes 192 accept
        }

        chain DOCKER {
        }

        chain DOCKER-BRIDGE {
        }

        chain DOCKER-CT {
        }

        chain DOCKER-INTERNAL {
        }

        chain ufw6-logging-deny {
                ct state invalid limit rate 3/minute burst 10 packets counter packets 0 bytes 0 return
                limit rate 3/minute burst 10 packets counter packets 0 bytes 0 log prefix "[UFW BLOCK] "
        }

        chain ufw6-logging-allow {
                limit rate 3/minute burst 10 packets counter packets 0 bytes 0 log prefix "[UFW ALLOW] "
        }

        chain ufw6-skip-to-policy-input {
                counter packets 0 bytes 0 drop
        }

        chain ufw6-skip-to-policy-output {
                counter packets 0 bytes 0 accept
        }

        chain ufw6-skip-to-policy-forward {
                counter packets 0 bytes 0 drop
        }

        chain ufw6-user-input {
                meta l4proto udp udp dport 21113 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 21115 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 21116 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 9091 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 9090 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 1194 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 22  counter packets 0 bytes 0 accept
                meta l4proto udp udp dport 51820 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 8081 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 80 counter packets 0 bytes 0 accept
                meta l4proto udp udp dport 7844 counter packets 0 bytes 0 accept
                meta l4proto udp udp dport 443 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 443 counter packets 0 bytes 0 accept
                meta l4proto tcp tcp dport 3456 counter packets 0 bytes 0 accept
        }

        chain ufw6-user-output {
        }

        chain ufw6-user-forward {
        }

        chain ufw6-user-logging-input {
        }

        chain ufw6-user-logging-output {
        }

        chain ufw6-user-logging-forward {
        }

        chain ufw6-user-limit {
                limit rate 3/minute counter packets 0 bytes 0 log prefix "[UFW LIMIT BLOCK] "
                counter packets 0 bytes 0 reject
        }

        chain ufw6-user-limit-accept {
                counter packets 0 bytes 0 accept
        }
}
table ip6 nat {
        chain PREROUTING {
                type nat hook prerouting priority dstnat; policy accept;
                fib daddr type local counter packets 2 bytes 224 jump DOCKER
        }

        chain INPUT {
                type nat hook input priority 100; policy accept;
        }

        chain OUTPUT {
                type nat hook output priority -100; policy accept;
                ip6 daddr != ::1 fib daddr type local counter packets 0 bytes 0 jump DOCKER
        }

        chain POSTROUTING {
                type nat hook postrouting priority srcnat; policy accept;
        }

        chain DOCKER {
        }
}